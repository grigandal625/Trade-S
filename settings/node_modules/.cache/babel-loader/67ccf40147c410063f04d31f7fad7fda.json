{"ast":null,"code":"import _classCallCheck from\"E:\\\\Olympcepy\\\\settings\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";/*global chrome*/var API=function API(){_classCallCheck(this,API);};API.recieved=function(callback){return function(event){try{callback(JSON.parse(event.currentTarget.responseText));}catch(e){}};};API.authorize=function(id,token,callback){var xhr=new XMLHttpRequest();xhr.open(\"POST\",\"https://trades.pythonanywhere.com/api\");var obj={method:\"auth\",data:{id:id,token:token}};xhr.onload=API.recieved(callback);xhr.send(JSON.stringify(obj));};API.getUserById=function(id,callback){var xhr=new XMLHttpRequest();xhr.open(\"POST\",\"https://trades.pythonanywhere.com/api\");var obj={method:\"user\",data:{id:id}};xhr.onload=API.recieved(callback);xhr.send(JSON.stringify(obj));};API.getUserByKey=function(key,callback){var xhr=new XMLHttpRequest();xhr.open(\"POST\",\"https://trades.pythonanywhere.com/api\");var obj={method:\"user\",data:{key:key}};xhr.onload=API.recieved(callback);xhr.send(JSON.stringify(obj));};API.getMyData=function(callback){var cb=callback;chrome.storage.local.get([\"userId\"],function(r){API.getUserById(r.userId,cb);});};API.setUserSetts=function(id,setts,callback){var xhr=new XMLHttpRequest();xhr.open(\"POST\",\"https://trades.pythonanywhere.com/api\");var obj={method:\"setts\",data:{id:id,setts:setts}};xhr.onload=API.recieved(callback);xhr.send(JSON.stringify(obj));};API.setUserSettsByKey=function(key,setts,callback){API.getUserByKey(key,function(resp){API.setUserSetts(resp.id,setts,callback);});};API.uploadMySetts=function(callback){var cb=callback;chrome.storage.local.get([\"settsData\",\"userId\"],function(res){var r=res;if(r.userId&&r.settsData){var setts={accessToken:r.settsData.accessToken?r.settsData.accessToken:undefined,messages:r.settsData.messages?r.settsData.messages.map(function(e){return{groupToken:e.groupToken?e.groupToken:undefined};}):undefined};API.setUserSetts(r.userId,setts,cb);}});};API.downloadMySetts=function(callback){var cb=callback;chrome.storage.local.get([\"settsData\",\"userId\"],function(res){var r=res;if(r.userId){API.getUserById(r.userId,function(user){var setts=r.settsData?r.settsData:{};setts.messages=user.setts.messages?user.setts.messages.map(function(e,i){e.toSend=setts.messages&&setts.messages[i]&&setts.messages[i].toSend?setts.messages[i].toSend:[];return e;}):[];setts.accessToken=user.setts.accessToken;chrome.storage.local.set({settsData:setts},function(){try{cb(setts);}catch(e){}});});}});};export default API;","map":{"version":3,"sources":["E:/Olympcepy/settings/src/API.js"],"names":["API","recieved","callback","event","JSON","parse","currentTarget","responseText","e","authorize","id","token","xhr","XMLHttpRequest","open","obj","method","data","onload","send","stringify","getUserById","getUserByKey","key","getMyData","cb","chrome","storage","local","get","r","userId","setUserSetts","setts","setUserSettsByKey","resp","uploadMySetts","res","settsData","accessToken","undefined","messages","map","groupToken","downloadMySetts","user","i","toSend","set"],"mappings":"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","sourcesContent":["/*global chrome*/\r\n\r\nclass API {\r\n    static recieved = (callback) => (event) => {\r\n        try {\r\n            callback(JSON.parse(event.currentTarget.responseText));\r\n        } catch (e) {}\r\n    };\r\n\r\n    static authorize = (id, token, callback) => {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open(\"POST\", \"https://trades.pythonanywhere.com/api\");\r\n        var obj = {\r\n            method: \"auth\",\r\n            data: { id: id, token: token },\r\n        };\r\n        xhr.onload = API.recieved(callback);\r\n        xhr.send(JSON.stringify(obj));\r\n    };\r\n\r\n    static getUserById = (id, callback) => {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open(\"POST\", \"https://trades.pythonanywhere.com/api\");\r\n        var obj = {\r\n            method: \"user\",\r\n            data: { id: id },\r\n        };\r\n        xhr.onload = API.recieved(callback);\r\n        xhr.send(JSON.stringify(obj));\r\n    };\r\n\r\n    static getUserByKey = (key, callback) => {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open(\"POST\", \"https://trades.pythonanywhere.com/api\");\r\n        var obj = {\r\n            method: \"user\",\r\n            data: { key: key },\r\n        };\r\n        xhr.onload = API.recieved(callback);\r\n        xhr.send(JSON.stringify(obj));\r\n    };\r\n\r\n    static getMyData = (callback) => {\r\n        var cb = callback;\r\n        chrome.storage.local.get([\"userId\"], (r)=>{\r\n            API.getUserById(r.userId, cb)\r\n        })\r\n    }\r\n\r\n    static setUserSetts = (id, setts, callback) => {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open(\"POST\", \"https://trades.pythonanywhere.com/api\");\r\n        var obj = {\r\n            method: \"setts\",\r\n            data: { id: id, setts: setts },\r\n        };\r\n        xhr.onload = API.recieved(callback);\r\n        xhr.send(JSON.stringify(obj));\r\n    };\r\n\r\n    static setUserSettsByKey = (key, setts, callback) => {\r\n        API.getUserByKey(key, (resp) => {\r\n            API.setUserSetts(resp.id, setts, callback);\r\n        });\r\n    };\r\n\r\n    static uploadMySetts = (callback) => {\r\n        var cb = callback;\r\n        chrome.storage.local.get([\"settsData\", \"userId\"], (res) => {\r\n            var r = res;\r\n            if (r.userId && r.settsData) {\r\n                var setts = {\r\n                    accessToken: r.settsData.accessToken\r\n                        ? r.settsData.accessToken\r\n                        : undefined,\r\n                    messages: r.settsData.messages\r\n                        ? r.settsData.messages.map((e) => {\r\n                              return {\r\n                                  groupToken: e.groupToken\r\n                                      ? e.groupToken\r\n                                      : undefined,\r\n                              };\r\n                          })\r\n                        : undefined,\r\n                };\r\n                API.setUserSetts(r.userId, setts, cb);\r\n            }\r\n        });\r\n    };\r\n\r\n    static downloadMySetts = (callback) => {\r\n        var cb = callback;\r\n        chrome.storage.local.get([\"settsData\", \"userId\"], (res) => {\r\n            var r = res;\r\n            if (r.userId) {\r\n                API.getUserById(r.userId, (user) => {\r\n                    var setts = r.settsData ? r.settsData : {};\r\n                    setts.messages = user.setts.messages\r\n                        ? user.setts.messages.map((e, i) => {\r\n                              e.toSend =\r\n                                  setts.messages &&\r\n                                  setts.messages[i] &&\r\n                                  setts.messages[i].toSend\r\n                                      ? setts.messages[i].toSend\r\n                                      : [];\r\n                              return e;\r\n                          })\r\n                        : [];\r\n                    setts.accessToken = user.setts.accessToken;\r\n                    chrome.storage.local.set({ settsData: setts }, () => {\r\n                        try {\r\n                            cb(setts);\r\n                        } catch (e) {}\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    };\r\n}\r\n\r\nexport default API;\r\n"]},"metadata":{},"sourceType":"module"}